{
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "background": "white",
    "padding": 5,
    "width": 500,
    "height": 300,
    "style": "cell",
    "data": [
      {
        "name": "source_0",
        "url": "https://raw.githubusercontent.com/sachin-f/vis2/master/js/aus.geo.topojson_states.json",
        "format": {"type": "topojson", "feature": "Australia_Polygon"}
      },
      {
        "name": "source_1",
        "url": "https://raw.githubusercontent.com/sachin-f/vis2/master/aus_air.csv",
        "format": {"type": "csv", "delimiter": ","},
        "transform": [
          {
            "type": "geojson",
            "fields": ["longitude_deg", "latitude_deg"],
            "signal": "layer_1_geojson_0"
          },
          {
            "type": "geopoint",
            "projection": "projection",
            "fields": ["longitude_deg", "latitude_deg"],
            "as": ["layer_1_x", "layer_1_y"]
          }
        ]
      }
    ],
    "projections": [
      {
        "name": "projection",
        "size": {"signal": "[width, height]"},
        "fit": {"signal": "[data('source_0'), layer_1_geojson_0]"},
        "type": "mercator"
      }
    ],
    "marks": [
      {
        "name": "layer_0_marks",
        "type": "shape",
        "style": ["geoshape"],
        "from": {"data": "source_0"},
        "encode": {
          "update": {
            "fill": {"value": "lightgray"},
            "stroke": {"value": "white"},
            "ariaRoleDescription": {"value": "geoshape"}
          }
        },
        "transform": [{"type": "geoshape", "projection": "projection"}]
      },
      {
        "name": "layer_1_marks",
        "type": "symbol",
        "style": ["circle"],
        "from": {"data": "source_1"},
        "encode": {
          "update": {
            "opacity": {"value": 0.7},
            "fill": {"value": "steelblue"},
            "tooltip": {
              "signal": "{\"Name\": isValid(datum[\"name\"]) ? datum[\"name\"] : \"\"+datum[\"name\"], \"Code\": isValid(datum[\"iata_code\"]) ? datum[\"iata_code\"] : \"\"+datum[\"iata_code\"]}"
            },
            "ariaRoleDescription": {"value": "circle"},
            "description": {
              "signal": "\"longitude_deg: \" + (format(datum[\"longitude_deg\"], \"\")) + \"; latitude_deg: \" + (format(datum[\"latitude_deg\"], \"\")) + \"; Name: \" + (isValid(datum[\"name\"]) ? datum[\"name\"] : \"\"+datum[\"name\"]) + \"; Code: \" + (isValid(datum[\"iata_code\"]) ? datum[\"iata_code\"] : \"\"+datum[\"iata_code\"])"
            },
            "x": {"field": "layer_1_x"},
            "y": {"field": "layer_1_y"},
            "size": {"value": 30},
            "shape": {"value": "circle"}
          },
          "hover": {"fill": {"value": "red"}, "size": {"value": 100}}
        }
      }
    ]
  }